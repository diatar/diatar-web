<html>
	<head>
		<title>
			Diatár a Veresvizen
		</title>
        <link rel="shortcut icon" href="graphics/diatar_icon.gif" type="image/gif" />
        
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        
		<script type="text/javascript" src="./JS/lib/prototype.js"></script>
		<script type="text/javascript" src="./JS/src/scriptaculous.js?load=effects"></script>
		<script type="text/javascript" src="./JS/lightbox.js"></script>
		
		<script type="text/javascript" src="./JS/POPUP_V3.js"></script>
		<script type="text/javascript" src="./JS/GENERAL.js"></script>
		
		<script type="text/javascript">
			initPopupForMouseoutDisengage();
		</script>
	
		<link rel="stylesheet" href="./CSS/lightbox.css" type="text/css" media="screen" />
		<link rel="stylesheet" href="./CSS/general.css" type="text/css" />
			
		<meta http-equiv="Content-Language" content="hu" />
  		<meta name="GENERATOR" content="PHP Designer 2007">
	   	
	</head>
	<body>
		<center>			
			<div class="frame">  <!-- frame -->
				<div class="frame_top"> </div> 
				<div class="frame_center"> <!-- frame_center-->
					<div class="frame_center_left">  <!-- CL-->
						<div class="frame_center_right">  <!-- CR-->
							<div class="frame_center_center">  <!-- CC-->
								<a rel="lightbox[templom]" href="graphics/Plebania.jpg" title="A plébániatemplom bejárata">
									<img src="graphics/veresvizi_kispb.jpg" class="frame_logo"/>
								</a>
<!--								
								<img src="graphics/logo.jpg" class="frame_logo" onmouseover="createIdSourcedPopupFromCursorOverlapped(this,'magnify',event,0,0)"/>															
-->
									<div class="frame_textpos"> <!-- textpos-->
										<div class="frame_title">
											Diatar								
										</div>
										<a href="../?page=ismerteto" title="Vissza !!">
                                            <div class="diatar_logo"></div>
                                        </a>
										<div class="frame_subtitle">						
											A nagybányai veresvizi 
											<br />
											Krisztus Király plébánia-templomban
										</div>
									</div> <!-- textpos-->
								</div> <!-- CC-->
							</div>	 <!-- CR-->				
						</div> <!-- CL-->								
					</div>  <!-- frame_center-->
					<div class="frame_bottom"></div>
			</div> <!-- frame -->
	   	
			<div class="text_box">
				 <p class="kis_text"> 
                     Már régebben szükségesnek láttuk, hogy a híveknek sgítséget nyújtsunk ahoz, hogy a Szentmise alatti énekekbe minél
                     többen könnyen be tudjanak kapcsolódni.
                     Többféle változatot kipróbáltunk: kezdetben un. éneklapokat készítettünk (ezeknek többnyire hamar "lába kelt".) 
				</p>
				<p class="kis_text spaced">	
					Aztán egy 3 szegmenses számkijelzővel próbáltuk az éppen soron következő ének számát megjelníteni. Ezzel az volt a baj, hogy a
                    híveknél talaható énekeskönyvek különbözőek voltak. Egyeseknek "Hozsannájuk", másoknak "Éneklő Egyházuk" volt,
                    de sokan egyáltalán semmilyen forrással nem rendelkeztek, így az ének számával nem sokat értek.
                </p>
				<p class="kis_text">
					A kijelző kezelése ugyanakkor nagyon nehézkes volt. Egy 3 db. forgotárcsát tartalmazó kapcsoló vezérelte, ennek kezelése -
                    főleg több, egymásután következő ének megjelenítésekor - komoly kihívás elé állította a kántort.
					Így hát lassanként elenyészett a kezdeményezés.
				</p>
				<p class="kis_text">
				 <a rel="lightbox[templom]" title="Kezdetben a padsor melletti asztalnál ülő kezelő irányította a vetítést. <br/>A vászon is a saját
                    talapozatán állt."
                    href="graphics/kezdetben.jpg"><img src="graphics/kezdetben_link.jpg" title="Így kezdetük..." style="float:right;margin-left:10px;"/></a> 
		  			Aztán - 2008 nyara végén - a Plébános Úr szorgalmazására, újra elkezdtünk foglalkozni a dologgal. A "Plébi" felajánlotta a 
                    plébánian található vetítőgépet és a saját notebookját.
		   			Mivel nem teljesen idegen tőlem a számítástehnika, úgy gondoltam, ezzel a felszereléssel már nem nagy ördöngősség a vetítést
                    megoldani. Kis erőfeszítéssel, az énekrend előzetes begépelésével, akár Word-ból, akár PowerPoint-ból viszonylag könnyen 
                    megoldható a vetítés. És működöt...
		    		</p>
				<p class="kis_text">
                    Csakhogy, a kényelem nagy úr! Igaz, ami igaz, nem sok kedvem volt a szombat estéket azzal tölteni, hogy többtíz-sornyi szöveget
                    begépeljek... Elkezdtem hát keresgélni a NET-en, és az első találatok között ott volt a DIATÁR! Nemcsak, hogy tartalmazza az
                    összes, általában (legalábbis nálunk) használt ének-szöveget, de ezen felűl egy nagyon jól kezelhető, kézreálló kezelőfelületet
                    is biztosít a vetítéshez. Ráadásúl - a fejlesztő jóvoltából - teljesen ingyen!.
    		    	Gondoltam, kipróbálom. Nem sok probálkozás kellett, hogy lássam, ez pontosan az, amit (csak úgy, magamban) megvalósításként 
                    elképzeltem. Azonnal használatba is vettem.		    		
				</p>
                <p class="kis_text">
                    Úgy működött, hogy a padsor mellet elhelyezett asztalon volt a laptop, arról vezérelte a vetítést a kezelő. A vásznat - 
                    kezdetben - saját álványán, a szentély baloldalán állítottuk föl. Csakhogy hamar jelentkeztek a megoldás hátrányai is.
                    Például, ha valami miatt az énekrendet módosítani kellett volna, akkor "bukta"! Nem volt rá lehetőség. Néha pedig 
                    a kezelő nézte el a váltás pillanatát, és csak a következő versszak közepén váltott. Szóval ez nem igazán volt rendben. 
                    Mást kellett kitalálni. Íme, mire jutottunk:
				</p>
			</div>
			<div class="text_box_next">   <!-- vetito elhelyezes -->
				 <p class="body_text"> 
				    A Vetítő elhelyezését hamar megoldottuk. Itthon talaható anyagokból összeszereltünk egy állványt, ezt padsor baloldalán, 
                    a padhoz rögzítettünk, erre került a vetítő.
	       		</p>
			     <a rel="lightbox[templom]" title="A vetítővászon tartókonzolja. <br/> 
                    A vászon visszahúzható a házába, legalábbis részben, ameddig a rugó bírja"
                    href="graphics/vaszonkonzol.jpg"><img src="graphics/vaszonkonzol_link.jpg" title="Vetítő vászon konzol" style="float:right; margin-right:10px; margin-left:10px;"/></a>
                <p class="body_text">
  				    A vetítővászon kezdetben a saját talpazatán állt, de hamarosan, egy segítőkész szakember segítségével csinos tartókonzol készült, amivel
                    a vásznat fejmagasság fölé, a falra tudtuk rögzíteni. Így már gyakorlatilag senkit sem zavar, de mindenki jól láthatja.
                    A konzol mozgatható, igy a vásznat szükség szerint be tudjuk állítani. A vászon "házát" és a "feltekerő mehanizmusát" megtartottuk,
                    így hét közben - hogy a vásznat megóvjuk a porosodástól - visszahúzzuk azt a házába.
				</p>
			</div>
            <div class="text_box_next">  <!-- vetitesi megoldas, taviranyito -->
                <p class="body_text"> 
                    Mostmár csak a vetítés vezérlését kellett megoldanunk. A kb. 50m-es video-kábel nem tünt jó megoldásnak.
                    Nem is igen tudtam, honnan szerezhetném be, és abban sem voltam biztos, hogy mőködne (bár Hozé szerint igen).
                    Ezért más megoldást kerestünk.
                </p>
                <p class="kis_text">
                    Azért a többesszám, mert a vezérlés kitalálásában - gyakorlatilag - én csak az ötletgazda voltam (néha még az sem). 
                    A konkrét megvalósítások, a fiam művei.
                </p>
    			<p class="body_text">
                    Első ötlet az volt, hogy készítünk egy PIC-vezérelt távirányítót. Ez az ötlet onnan származott, hogy a számítógép vezérlésére 
                    már régebben is használtam(tunk) egy IR-vevőt (hasonlót ahoz amit TV-k, és hasonló eszközök távirányításásra használnak).
                    Ennek a jeleit egy <a href="http://www.promixis.com/girder.php" target="_blank">Girder</a> nevű progi fogadta és dogozta fel. 
                    Ezzel, gyakorlatilag, a számítógép bármilyen funkciója vezérelhető.
                    A progrtam (egy <a href="http://www.cesko.host.sk/downloads/IgorPlugXP.zip" target="_blank">plug-in</a> segítségével 
                    - ha esetleg az előző link nem működne <a href="http://www.cesko.host.sk" target="_blank">itt</a>
                    lehet keresgélni -) a TV távirányítóknál is használt, idő-intervallum kiértékelésén alapuló prtokollt alkalmaz.
                    A rendelkezésre álló távirányítók kódját, egy PIC-vezérelt kapcsolással, "viszonylag könnyen" visszafejtettük. 
                    Persze, egy TV távirányító hatótávolsága csekély, igy ez a templomban használhatatlan. 
                </p>
                <p class="kis_text">
			    <a rel="lightbox[templom]" title="Ezzel a LED-tömbbel sem sikerült a hatótávolságot megnövelni. Sőt!"
                    href="graphics/ir_ledek.jpg"><img src="graphics/ir_ledek_link.jpg"  title="Távirányító próbálkozás" style="float:right; margin-right:10px; margin-left:10px;"/></a>
                    Úgy gondoltuk, hogy, ha 1 darab IR-LED helyett egy LED-csoportot használnánk, elég teljesítményt kapunk ahoz, hogy nagyobb távolságból is működjön
                    a cucc. Ennél nagyobb tévedést!?! Sajnos a LED-ek nem úgy működnek, ahogy mi elképzeltük. Valószínűleg a gyújtási fáziskésésük (vagyis az,
                    hogy nem egyszerre kapcsolnal be és ki, akkor sem, ha egyforma jelet kapnak) volt az oka annak, hogy még az 1 LED-es távirányító hatótávolságát
                    sem értük így el.
                    Erről tehát le kellet mondanunk. Egyébként, ha működött volna, akkor sem oldotta volna meg azt, hogy "menet közben" ie elvégezhetőek legyenek
                    az esetleges módosítások.
                 </p>
                <p class="kis_text"> 
                    Közben azzal is kísérleteztem, hogy - a saját laptopomat is beüzemelve - a két gép között un. ad-hock WiFi-s kapcsolatot hoztak létre,
                    így már tudtam a kórusról vezérelni a vetítést.
                    Az ad-hock kapcsolat azonban nem a legsikeresebb választás. A kapcsolat létrehozásához ugyanis minkét géphez hozzá kell férni.
                    Ha üzem közben valami miatt (pd. bekapcsol a képernyővédő) megszakad a kapcsolat, újabb bukta. Nem mindig lehet futkározni egyik géptől a másihoz.
                    És biza előfordúlt, amikor legkevésbé szerettem volna.
                </p>
 			</div>      
            <div class="text_box_next"> <!-- vegleges megoldas -->   
                <p class="body_text"> 
                    Végül úgy döntöttünk, hogy a kétgépes megoldást fejlesztjük ki. 
                    Legyen 1 gép a vetítő közelében. Ez vezérli a vetítőt a padsor mellől. Ezt a gépet akár helyileg, akár távirányítással vezérelhetjük.
                    A második gép a kóruson lesz, az orgona közelében, erről lehet távirányítani az előbbit.
                    Ez a változat egyúttal azt is megoldja, hogy akár a kórusról, akár a pad mellől vezérelhető a vetítés.
                    A két gép közötti kapcsolat lehet LAN-kábel, vagy WiFi.  
                </p>
                <p class="body_text">
			         <a rel="lightbox[templom]"  title="A vetítő rendszer. A padsor melletti asztalra fektettük a számítógépet.  <br/> A tetejéből kikandikál a ruter WiFi-antennája.<br/> A pad széléhez erősített állványon áll a projektor. <br/>Háttérben a kinyitott vászon"
                        href="graphics/vetito_gep.jpg"><img src="graphics/vetito_gep_link.jpg"  title="A vetítő gép" style="float:left; margin-right:10px; margin-left:10px;"/></a>
                    Az itthoni gépfelújítások alkalmával félretett alkatrészekből összeraktunk egy gépet. Ez lett a vetítő. (Szinte minden megvolt,
                    csak a házzal volt egy kis fennakadás. Fekvő házat szerettem vola, de ez végűl nem jött össze, ezért egy álló házet "fektettünk" le.)
                    A távolság miatt, szinte annyiba került volna a LAN-kábel, mint amennyiért tudtunk venni egy WiFi routert. Így a hálozat WiFi lett.
                </p>
                <p class="body_text">
			         <a rel="lightbox[templom]" title="A vezérlő gép állványa az orgona mellett.  <br/> Jobbra fenn az állványra helyezett, üzembehelyezett vezérlőgép, baloldali USB-csatlakozojában az USB-RS232-es átalakító"
                        href="graphics/gepallvany.jpg"><img src="graphics/gepallvany_link.jpg"  title="A vezérlő gép állványa" style="float:right; margin-right:10px; margin-left:10px;"/></a>
                    A vezélő gép - egyelőre - a saját laptopom (kényelmesebb így, mintha a plébi laptopját csenném el minden alkalommal).
                    A későbbiekben ide is szeretnénk egy "fix" gépet telepíteni. Ugyanaz a szaki, aki a vászon konzolját készítette, most is segített,
                    és a laptopnak is lett állványa. Ha meglessz ide is a gép, erre az állványra kerül majd a monitor, és ide rögzítjük a billentyűzet
                    és az egér "asztalát" is.
    			</p>
                <p class="body_text">
			         A vetítés kezelése azonban még így is nehézkes volt. Kellett egy vezérlő gombsor.
    			</p>
			</div>
            <div class="text_box_next"> <!-- taviranyito -->
                <p class="body_text">
                   Mivel a programba bele van építve a kezeléséhez szükséges protokoll, ez már nem volt túl bonyolult.
                    A rendszer alapja egy PIC16F876 típusu mikrokontroller. Azért választottuk ezt, mert:
                </p>
                <ul>
                      <li>a távirányító-kísérlethez is ezt használtuk, nem kellett újat venni</li>
                      <li>könnyen programozható, mert soros porton kommunikál. Egy USB-s megoldáshoz más PIC kellett volna, és az PIC USB-interfészének
                          a felprogramozásához nem találtunk ingyenes megoldást</li>
                      <li>Az USB kapcsolathoz megvolt az <a href="http://www.bb-elec.com/product.asp?sku=UC232A"  target="_blank">RS232-USB átalakító</a>,
                          amit már a <a href="http://www.promixis.com/girder.php" target="_blank">girderhez</a> is használtam. </li>
                </ul> 
                <p class="body_text">
			       <a rel="lightbox[templom]" title="A bal mezőben a PIC vezerlő áramkör doboza látható.A zöld LED bekapcsoláskor villogni kezd, majd mikor a vezérlőegység összekapcsolódik a programmal, folyamatos üzermre vált.  <br/> A jobb mezőben a vezérlő kapcsologombjai, a két LED világít, mert a háttér és a vetítés is be van kapcsolva."
                        href="graphics/gombok.jpg"><img src="graphics/gombok_link.jpg"  title="Kezelőgombok és a PIC áramkör doboza" style="float:right; margin-right:10px; margin-left:10px;"/></a>
                   Az orgona játszóasztalába sajnos nem lehetett beépíteni a gombsort, ezért a rendszert úgy alakítottuk ki,
                    hogy egy külön dobozba került a "logika", és az orgona asztalára csak a gombokat tartó (igaz, nem túl elegáns) tartóhíd került.
                    Jelenleg 6 gombot használunk (a lehetséges 8-ból). Ezek: léptetés előre-hátra, ugrás az előző-következő énekre, vetítés ki-bekapcsolása,
                    valamint a háttérkép ki-bekapcsolása.
                </p>  
                <p class="body_text">
			       <a rel="lightbox[templom]"title="A vezérlő-rendszer, munka közben." 
                        href="graphics/vezerlo_gep.jpg"><img src="graphics/vezerlo_gep_link.jpg" title="A kész vezérlőrendszer" style="float:left; margin-left:10px; margin-left:10px;"/></a>
                   Így elkészült a jelenleg véglegesnek mondható hardware-kiépítés.
                </p>  
                <p class="body_text">
			    Itt a <a href="graphics/PIC_Kapcsolas.jpg" target="_blank">vezérlő áramköri rajza</a>. A rajz csak vázlatos, pontos értékeket nem tartalmaz.
                </p>  
                <p class="body_text">
                     Ez pedig a<a href="PIC_kod.html" target="_blank"> PIC vezérlőkódja </a>. Kisebb mődosításokkal más típusú PIC-re is átültethető.
                </p>
                <p class="body_text">
                    Ennyire jutottunk egyelőre. További fejlesztésekről alkalomadtán, természetesen, majd beszámolok.
                </p>   
                <p class="kis_text">
                    Ha valakit részletesebben érdekelne a megoldás egyik-másik részlete, vagy bármi más kérdése, kérése lenne, szívesen állok rendelkezésre.
                    Ha beüzemelési gondok adódnak, akár - előzetes egyeztetést küvetően - távirányításos segítséget is nyujtani tudok.
                    <a href="../index.php?page=uzenetkuldes&cim=jancsi@diatar.eu">Üzenetet itt lehet küldeni</a>
                </p>                        
  			</div>          
            <div class="text_box_next"> <!-- link -->
                <p class="body_text">
                   <a href="../index.php">Vissza a főoldalra </a>
                </p>
            </div>

<!--
				<div style="display:yes;background:white;opacity:0.5;filter:alpha(opacity=50%)" id="magnify">
					<a rel="lightbox[]" href="graphics/Plebania.jpg">
						klikk a nagyitashoz
					</a>
				</div>
-->			
		</center>
	</body>	
</html>